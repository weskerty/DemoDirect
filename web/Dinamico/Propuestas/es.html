<div style="text-align:center;">
    <h1>✨Lista de Propuestas✨</h1>
    <div class="grid-gallery" 
         id="propuestas-grid"
         data-json-path="web/Dinamico/data.json">
        <!-- imagenes dinamicas -->
    </div>
    
    <a href="web/es.html" class="back-button">← Volver al Inicio</a>
</div>

<script>
async function loadGalleryData(jsonPath) {
    try {
        const response = await fetch(jsonPath);
        const data = await response.json();
        return data.galleries;
    } catch (error) {
        console.error(`Error loading gallery data from ${jsonPath}:`, error);
        return null;
    }
}

function createGridGallery(container, images) {
    container.innerHTML = images.map(item => `
        <a href="${item.link || '#'}">
            <img src="${item.image}" alt="${item.name || 'Imagen'}" loading="lazy" />
        </a>
    `).join('');
}

function filterGalleryData(galleryData, container) {
    const galleryKey = container.dataset.galleryKey;
    const galleryFilter = container.dataset.galleryFilter;
    const containerId = container.id.replace('-grid', '');
    
    if (galleryKey && galleryData[galleryKey]) {
        return galleryData[galleryKey].images || [];
    }
    
    if (galleryFilter) {
        const matchingEntries = Object.entries(galleryData).filter(([key, value]) => 
            key.toLowerCase().includes(galleryFilter.toLowerCase())
        );
        
        if (matchingEntries.length > 0) {
            return matchingEntries.flatMap(([key, value]) => value.images || []);
        }
    }
    
    const matchingKey = Object.keys(galleryData).find(key => 
        key.toLowerCase() === containerId.toLowerCase()
    );
    
    if (matchingKey && galleryData[matchingKey]) {
        return galleryData[matchingKey].images || [];
    }
    
    return [];
}

async function initializeUniversalGallery() {
    const gridElements = document.querySelectorAll('.grid-gallery[data-json-path]');
    
    for (const container of gridElements) {
        const jsonPath = container.dataset.jsonPath;
        
        if (!jsonPath) {
            container.innerHTML = '<p>No se especificó ruta JSON</p>';
            continue;
        }
        
        const galleryData = await loadGalleryData(jsonPath);
        
        if (!galleryData) {
            container.innerHTML = '<p>Error al cargar datos</p>';
            continue;
        }
        
        const images = filterGalleryData(galleryData, container);
        
        if (images.length > 0) {
            createGridGallery(container, images);
        } else {
            container.innerHTML = '<p>Sin Elementos</p>';
        }
    }
}

initializeUniversalGallery();
</script>